<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>时间记录器</title>
  <link rel="manifest" href="manifest.json" />
  <style>
    /* 全局样式：冷淡风格 */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #ffffff;
      color: #333;
      margin: 20px;
    }
    #clock {
      font-size: 20px;
      margin-bottom: 20px;
      text-align: center;
      color: #333;
    }
    h1 {
      color: #333;
      margin-bottom: 10px;
    }
    /* Flex容器，用于左右布局按钮 */
    #buttonContainer {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }
    button {
      display: block;
      width: auto;
      padding: 10px 20px;
      margin: 10px 0;
      font-size: 16px;
      border: 1px solid #ccc;
      background: #f9f9f9;
      color: #333;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background: #eee;
    }
    p {
      font-size: 18px;
      margin: 10px 0;
    }
    #clearBtn {
      margin-top: 40px;
    }
    /* 实时显示区域样式 */
    #timerDisplayArea {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <!-- 实时电子钟 -->
  <div id="clock">加载时间...</div>

  <h1>时间记录器</h1>

  <div id="buttonContainer">
    <div id="timerButtons">
      <button id="startWorkBtn">开始工作</button>
      <button id="stopWorkBtn" disabled>停止工作</button>
      <button id="startPlayBtn">开始娱乐</button>
      <button id="stopPlayBtn" disabled>停止娱乐</button>
    </div>
    <div id="manualButtons">
      <button id="workBtn">记录工作时间</button>
      <button id="playBtn">记录娱乐时间</button>
    </div>
  </div>

  <!-- 实时计时显示区域 -->
  <div id="timerDisplayArea">
    <p id="workTimerDisplay"></p>
    <p id="playTimerDisplay"></p>
  </div>

  <p>工作时长: <span id="workTime">0min</span></p>
  <p>娱乐时长: <span id="playTime">0min</span></p>
  <p>差值 (工作-娱乐): <span id="diffTime">0min</span></p>

  <button id="clearBtn">一键清空</button>
  
  <script>
    // 实时电子钟更新
    function updateClock() {
      const now = new Date();
      const year = now.getFullYear();
      const month = String(now.getMonth() + 1).padStart(2, '0');
      const day = String(now.getDate()).padStart(2, '0');
      const hour = String(now.getHours()).padStart(2, '0');
      const minute = String(now.getMinutes()).padStart(2, '0');
      const second = String(now.getSeconds()).padStart(2, '0');
      document.getElementById('clock').textContent = `${year}年 ${month}月 ${day}日 ${hour}:${minute}:${second}`;
    }
    setInterval(updateClock, 1000);
    updateClock();

    let events = JSON.parse(localStorage.getItem('events')) || [];
    let workTimerStart = null;
    let playTimerStart = null;
    let workInterval = null;
    let playInterval = null;

    function updateDisplay() {
      let workEvents = events.filter(e => e.type === 'work');
      let playEvents = events.filter(e => e.type === 'play');
      let workSum = workEvents.reduce((sum, e) => sum + e.value, 0);
      let playSum = playEvents.reduce((sum, e) => sum + e.value, 0);
      let diffSum = workSum - playSum;
      let workExpr = workEvents.map(e => e.value).join('+') || '0';
      let playExpr = playEvents.map(e => e.value).join('+') || '0';
      let diffExpr = events.map(e => (e.type === 'work' ? '+' + e.value : '-' + e.value)).join('');
      if(diffExpr.startsWith('+')) diffExpr = diffExpr.substring(1);
      document.getElementById('workTime').textContent = `${workExpr}=${workSum}min`;
      document.getElementById('playTime').textContent = `${playExpr}=${playSum}min`;
      document.getElementById('diffTime').textContent = `${diffExpr}=${diffSum}min`;
    }

    document.getElementById('workBtn').addEventListener('click', () => {
      const amount = parseFloat(prompt('你工作了多少分钟？'));
      if (!isNaN(amount) && amount > 0) {
        events.push({type: 'work', value: amount});
        localStorage.setItem('events', JSON.stringify(events));
        updateDisplay();
      }
    });

    document.getElementById('playBtn').addEventListener('click', () => {
      const amount = parseFloat(prompt('你娱乐了多少分钟？'));
      if (!isNaN(amount) && amount > 0) {
        events.push({type: 'play', value: amount});
        localStorage.setItem('events', JSON.stringify(events));
        updateDisplay();
      }
    });

    // 开始工作逻辑
    document.getElementById('startWorkBtn').addEventListener('click', () => {
      if(workTimerStart === null) {
        workTimerStart = Date.now();
        document.getElementById('startWorkBtn').disabled = true;
        document.getElementById('stopWorkBtn').disabled = false;
        workInterval = setInterval(() => {
          let elapsedMs = Date.now() - workTimerStart;
          let h = Math.floor(elapsedMs / 3600000);
          let m = Math.floor((elapsedMs % 3600000) / 60000);
          let s = Math.floor((elapsedMs % 60000) / 1000);
          document.getElementById('workTimerDisplay').textContent = `工作了：${h}h ${m}min ${s}s`;
        }, 1000);
      }
    });

    document.getElementById('stopWorkBtn').addEventListener('click', () => {
    
